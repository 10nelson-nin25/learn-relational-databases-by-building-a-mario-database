version: '0.2.2'
config:
  testRunner:
    command: ./node_modules/.bin/mocha
    args:
      tap: --reporter=mocha-tap-reporter
    setup:
      commands:
        #
        - sudo service postgresql stop
        # run npm install in freeCodeCamp folder on load to install testing dependecies
        - npm install
        # update permissions to log file
        - sudo chmod 777 test/pg.log
        # copy config file to new location
        - sudo cp postgresql.conf /etc/postgresql/12/main/postgresql.conf
        - sudo cp pg_hba.conf /etc/postgresql/12/main/pg_hba.conf
        # - sudo chmod 777 /home && sudo chmod 777 /home/strove && sudo chmod 777 /home/strove/project && sudo chmod 777 /home/strove/project/freeCodeCamp && sudo chmod 777 /home/strove/project/freeCodeCamp/test && sudo chmod 777 /home/strove/project/freeCodeCamp/test/pg.log
        # change psql configs and connections allowed
        # cd /etc/postgresql/12/main && sudo chmod 777 postgresql.conf && echo "log_statement = 'all'" >> postgresql.conf && echo "log_min_error_statement = INFO" >> postgresql.conf && echo "log_min_messages = INFO" >> postgresql.conf && echo "logging_collector = on" >> postgresql.conf && echo "log_directory = '/home/strove/project/freeCodeCamp/test'" >> postgresql.conf && echo "log_filename = 'pg.log'" >> postgresql.conf && echo "log_connections = on" >> postgresql.conf && echo "log_line_prefix = '%u '" >> postgresql.conf && sudo sed -i "s/peer/trust/" pg_hba.conf && sudo sed -i "s/md5/trust/" pg_hba.conf
        - sudo service postgresql start
        # create freecodecamp user
        - sudo -u postgres psql -c "CREATE USER freecodecamp WITH CREATEDB;"
    directory: freeCodeCamp
  repo:
    uri: https://github.com/moT01/learn-relational-databases-by-building-a-mario-database
    branch: v0.2.2
  dependencies:
    - name: node
      version: '>=10'
levels:
  - id: '20'
    steps:
      - id: '20.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '30'
    steps:
      - id: '30.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '40'
    steps:
      - id: '40.1'
  - id: '50'
    steps:
      - id: '50.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '60'
    steps:
      - id: '60.1'
  - id: '70'
    steps:
      - id: '70.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '80'
    steps:
      - id: '80.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '90'
    steps:
      - id: '90.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '100'
    steps:
      - id: '100.1'
  - id: '110'
    steps:
      - id: '110.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '120'
    steps:
      - id: '120.1'
  - id: '130'
    steps:
      - id: '130.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '140'
    steps:
      - id: '140.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '150'
    steps:
      - id: '150.1'
  - id: '160'
    steps:
      - id: '160.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '170'
    steps:
      - id: '170.1'
  - id: '180'
    steps:
      - id: '180.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '190'
    steps:
      - id: '190.1'
  - id: '200'
    steps:
      - id: '200.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '210'
    steps:
      - id: '210.1'
  - id: '220'
    steps:
      - id: '220.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '230'
    steps:
      - id: '230.1'
  - id: '240'
    steps:
      - id: '240.1'
  - id: '250'
    steps:
      - id: '250.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '260'
    steps:
      - id: '260.1'
  - id: '270'
    steps:
      - id: '270.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '280'
    steps:
      - id: '280.1'
  - id: '290'
    steps:
      - id: '290.1'
        setup:
          watchers:
            - ./freeCodeCamp/test/pg.log
  - id: '300'
    steps:
      - id: '300.1'

